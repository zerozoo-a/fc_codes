import { __asyncGenerator, __await, __generator } from "tslib.js";
import { isAsyncIterable, isIterable } from "../_internal/utils.js";
import toArray from "../toArray.js";
import isArray from "../isArray.js";
import isString from "../isString.js";
import concurrent, { isConcurrent } from "./concurrent.js";
function sync(length, iterable) {
    var arr, index, i;
    return __generator(this, function (_a) {
        switch (_a.label) {
            case 0:
                arr = isArray(iterable) || isString(iterable) ? iterable : toArray(iterable);
                index = arr.length - length;
                i = index;
                _a.label = 1;
            case 1:
                if (!(i < arr.length)) return [3 /*break*/, 4];
                if (!arr[i]) return [3 /*break*/, 3];
                return [4 /*yield*/, arr[i]];
            case 2:
                _a.sent();
                _a.label = 3;
            case 3:
                i++;
                return [3 /*break*/, 1];
            case 4: return [2 /*return*/];
        }
    });
}
function asyncSequential(length, iterable) {
    return __asyncGenerator(this, arguments, function asyncSequential_1() {
        var arr, index, i;
        return __generator(this, function (_a) {
            switch (_a.label) {
                case 0: return [4 /*yield*/, __await(toArray(iterable))];
                case 1:
                    arr = _a.sent();
                    index = arr.length - length;
                    i = index;
                    _a.label = 2;
                case 2:
                    if (!(i < arr.length)) return [3 /*break*/, 6];
                    if (!arr[i]) return [3 /*break*/, 5];
                    return [4 /*yield*/, __await(arr[i])];
                case 3: return [4 /*yield*/, _a.sent()];
                case 4:
                    _a.sent();
                    _a.label = 5;
                case 5:
                    i++;
                    return [3 /*break*/, 2];
                case 6: return [2 /*return*/];
            }
        });
    });
}
function async(length, iterable) {
    var _a;
    var iterator;
    return _a = {},
        _a[Symbol.asyncIterator] = function () {
            return this;
        },
        _a.next = function (_concurrent) {
            if (iterator === undefined) {
                iterator = isConcurrent(_concurrent)
                    ? asyncSequential(length, concurrent(_concurrent.length, iterable))
                    : asyncSequential(length, iterable);
            }
            return iterator.next(_concurrent);
        },
        _a;
}
function takeRight(l, iterable) {
    if (l < 0) {
        throw new RangeError("'length' must be greater than 0");
    }
    if (iterable === undefined) {
        return function (iterable) {
            return takeRight(l, iterable);
        };
    }
    if (isIterable(iterable)) {
        return sync(l, iterable);
    }
    if (isAsyncIterable(iterable)) {
        return async(l, iterable);
    }
    throw new TypeError("'iterable' must be type of Iterable or AsyncIterable");
}
export default takeRight;
//# sourceMappingURL=takeRight.js.map